{
  "hash": "54b41cf298836bb24875956f477433d2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Dataset Exploration - Week 6\"\ndescription: \"For Week 6 we are exploring the Stroke Dataset\"\nauthor:\n  - name: Renan Monteiro Barbosa\n    url: https://github.com/renanmb\n    affiliation: Master of Data Science Program @ The University of West Florida (UWF)\n    # affiliation-url: https://ucsb-meds.github.io/\n# date: 10-24-2022\ncategories: [dataset exploration, week 6, renan]\n# citation:\n#   url: https://samanthacsik.github.io/posts/2022-10-24-my-blog-post/\nimage: images/spongebob-imagination.jpg\ndraft: false\nbibliography: references.bib\nlink-citations: true\n---\n\nThis post start at Week 6 and extended over several week. From the discoveries made from Week 5 using the dataset [Stroke Prediction Dataset](https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset) we will be further exploring it by using insights found in @hassan2024predictive. So to develop a better insight we will be reproducing the research work in this post. \n\n## Introduction\n\nThe issue of data imbalance is a big problem for stroke ­prediction @kokkotis2022explainable. Because of many reasons ranging from privacy to the difficulty of doing cohort studies, the fact that pre-stroke datasets are rare, dataset often contain imbalanced classifications, with most instances being non-stroke c­ases @sirsat2020machine. So its unnecessary to say that this imbalance can result in biased models that favour the majority and ignore the minority, resulting in low forecast accuracy. To solve this issue and increase the effectiveness of the predictive models, we plan on exploring several oversampling and undersampling methods and much more are explored and employed, the popular of which is the ­SMOTE @wongvorachan2023comparison, @sowjanya2023effective.\n\n\n## 1. Setup and Data Loading\n\nFirst, we need to load the required R packages and the dataset. The dataset is publicly available on Kaggle and was originally created by McKinsey & Company @fedesorianoStrokePredictionDatasetKaggle.\n\n### 1.1 Load Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Run this once to install all the necessary packages\n# install.packages(c(\"corrplot\", \"ggpubr\", \"caret\", \"mice\", \"ROSE\", \"ranger\", \"stacks\", \"tidymodels\"))\n# install.packages(\"themis\")\n# install.packages(\"xgboost\")\n# install.packages(\"gghighlight\")\noptions(repos = c(CRAN = \"https://cloud.r-project.org\"))\ninstall.packages(c(\"dplyr\", \"car\", \"ResourceSelection\", \"caret\", \"pROC\",  \"logistf\", \"ggplot2\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nThe following package(s) will be installed:\n- car               [3.1-3]\n- caret             [7.0-1]\n- dplyr             [1.1.4]\n- ggplot2           [4.0.0]\n- logistf           [1.26.1]\n- pROC              [1.19.0.1]\n- ResourceSelection [0.3-6]\nThese packages will be installed into \"~/Documents/GitHub/renanmb/IDC-6940---Capstone-Project-Fall-2025/website/renv/library/linux-ubuntu-jammy/R-4.5/x86_64-pc-linux-gnu\".\n\n# Installing packages --------------------------------------------------------\n- Installing dplyr ...                          OK [linked from cache]\n- Installing ggplot2 ...                        OK [linked from cache]\n- Installing car ...                            OK [linked from cache]\n- Installing ResourceSelection ...              OK [linked from cache]\n- Installing pROC ...                           OK [linked from cache]\n- Installing caret ...                          OK [linked from cache]\n- Installing logistf ...                        OK [linked from cache]\nSuccessfully installed 7 packages in 9.1 milliseconds.\n```\n\n\n:::\n:::\n\n\nWe can use this to check installed packages:\n\n```{{r}}\nrenv::activate(\"website\")\n\"yardstick\" %in% rownames(installed.packages())\n```\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\npackages <- c(\"dplyr\", \"car\", \"ResourceSelection\", \"caret\", \"pROC\",  \"logistf\", \"ggplot2\")\nlapply(packages, library, character.only = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n[1] \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\" \"datasets\"  \"utils\"    \n[7] \"methods\"   \"base\"     \n\n[[2]]\n [1] \"car\"       \"carData\"   \"dplyr\"     \"stats\"     \"graphics\"  \"grDevices\"\n [7] \"datasets\"  \"utils\"     \"methods\"   \"base\"     \n\n[[3]]\n [1] \"ResourceSelection\" \"car\"               \"carData\"          \n [4] \"dplyr\"             \"stats\"             \"graphics\"         \n [7] \"grDevices\"         \"datasets\"          \"utils\"            \n[10] \"methods\"           \"base\"             \n\n[[4]]\n [1] \"caret\"             \"lattice\"           \"ggplot2\"          \n [4] \"ResourceSelection\" \"car\"               \"carData\"          \n [7] \"dplyr\"             \"stats\"             \"graphics\"         \n[10] \"grDevices\"         \"datasets\"          \"utils\"            \n[13] \"methods\"           \"base\"             \n\n[[5]]\n [1] \"pROC\"              \"caret\"             \"lattice\"          \n [4] \"ggplot2\"           \"ResourceSelection\" \"car\"              \n [7] \"carData\"           \"dplyr\"             \"stats\"            \n[10] \"graphics\"          \"grDevices\"         \"datasets\"         \n[13] \"utils\"             \"methods\"           \"base\"             \n\n[[6]]\n [1] \"logistf\"           \"pROC\"              \"caret\"            \n [4] \"lattice\"           \"ggplot2\"           \"ResourceSelection\"\n [7] \"car\"               \"carData\"           \"dplyr\"            \n[10] \"stats\"             \"graphics\"          \"grDevices\"        \n[13] \"datasets\"          \"utils\"             \"methods\"          \n[16] \"base\"             \n\n[[7]]\n [1] \"logistf\"           \"pROC\"              \"caret\"            \n [4] \"lattice\"           \"ggplot2\"           \"ResourceSelection\"\n [7] \"car\"               \"carData\"           \"dplyr\"            \n[10] \"stats\"             \"graphics\"          \"grDevices\"        \n[13] \"datasets\"          \"utils\"             \"methods\"          \n[16] \"base\"             \n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\n# For data manipulation and visualization\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(corrplot)\nlibrary(knitr)\nlibrary(ggpubr)\n\n# # For data preprocessing and modeling\n# library(caret)\n# library(mice)\n# library(ROSE) # For SMOTE\n# library(ranger) # A fast implementation of random forests\n\n# # For stacking/ensemble models\nlibrary(stacks)\nlibrary(tidymodels)\n\nlibrary(themis)\nlibrary(gghighlight)\n\n# Set seed for reproducibility\nset.seed(123)\n```\n:::\n\n\nMight need to deal with the conflicts later:\n\n\n### 1.2 Load Data\n\nWe will load the dataset and handle the data given the exploration done in Week5. The id column is unnecessary for prediction as well there are only 2 genders significant for prediction.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfind_git_root <- function(start = getwd()) {\n  path <- normalizePath(start, winslash = \"/\", mustWork = TRUE)\n  while (path != dirname(path)) {\n    if (dir.exists(file.path(path, \".git\"))) return(path)\n    path <- dirname(path)\n  }\n  stop(\"No .git directory found — are you inside a Git repository?\")\n}\n\nrepo_root <- find_git_root()\ndatasets_path <- file.path(repo_root, \"datasets\")\nkaggle_dataset_path <- file.path(datasets_path, \"kaggle-healthcare-dataset-stroke-data/healthcare-dataset-stroke-data.csv\")\nkaggle_data1 = read_csv(kaggle_dataset_path, show_col_types = FALSE)\n\n# unique(kaggle_data1$bmi)\nkaggle_data1 <- kaggle_data1 %>%\n  mutate(bmi = na_if(bmi, \"N/A\")) %>%   # Convert \"N/A\" string to NA\n  mutate(bmi = as.numeric(bmi))         # Convert from character to numeric\n\n# Remove the 'Other' gender row and the 'id' column\nkaggle_data1 <- kaggle_data1 %>%\n  filter(gender != \"Other\") %>%\n  select(-id) %>%\n  mutate_if(is.character, as.factor) # Convert character columns to factors for easier modeling\n```\n:::\n\n\n#### 1.2.1 Steve Dataset\n\nBelow will be loading the stroke.csv and performing necessary changes to the dataset and loading into the DataFrame: stroke1\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Reading the datafile in (the same one you got for us Renan)#\nsteve_dataset_path <- file.path(datasets_path, \"steve/stroke.csv\")\nstroke1 = read_csv(steve_dataset_path, show_col_types = FALSE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# stroke1 <- read.csv(\"stroke.csv\")\nstroke1[stroke1 == \"N/A\" | stroke1 == \"Unknown\" | stroke1 == \"children\" | stroke1 == \"other\"] <- NA\nstroke1$bmi <- round(as.numeric(stroke1$bmi), 2)\nstroke1$gender[stroke1$gender == \"Male\"] <- 1\nstroke1$gender[stroke1$gender == \"Female\"] <- 2\nstroke1$gender <- as.numeric(stroke1$gender)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: NAs introduced by coercion\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstroke1$stroke <- as.factor(stroke1$stroke)\nstroke1_clean <- na.omit(stroke1)\nstrokeclean <- stroke1_clean\n```\n:::\n\n\nThe model For Logistic Regression predicting Stroke\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformula <- stroke ~ gender + age + hypertension + heart_disease + ever_married +\n  work_type + Residence_type + avg_glucose_level + bmi + smoking_status\n```\n:::\n\n\nHistograms for all the predictors and the Outcome variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = gender)) +\n  geom_bar(fill = \"blue\", \n           color = \"white\") +\n  labs(title = \"Histogram of gender\", \n       x = \"gender\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = age)) +\n  geom_histogram(binwidth = 5, \n                 fill = \"green\", \n                 color = \"white\") +\n  labs(title = \"Histogram of Age\", \n       x = \"Age\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = hypertension)) +\n  geom_bar(fill = \"purple\", \n           color = \"white\") +\n  labs(title = \"Histogram of hypertension\", \n       x = \"hypertension\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = heart_disease)) +\n  geom_bar( fill = \"orange\",\n            color = \"white\") +\n  labs(title = \"Histogram of heart_diseasd\", \n       x = \"Age\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = ever_married)) +\n  geom_bar(fill = \"aquamarine\", \n           color = \"white\") +\n  labs(title = \"Histogram of ever_married\", \n       x = \"Age\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = work_type)) +\n  geom_bar(fill = \"steelblue\", \n           color = \"white\") +\n  labs(title = \"Histogram of work_type\", \n       x = \"Age\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = Residence_type)) +\n  geom_bar(fill = \"magenta\", \n           color = \"white\") +\n  labs(title = \"Histogram of Residence_type\", \n       x = \"Residence_type\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = avg_glucose_level)) +\n  geom_histogram(binwidth = 5, \n                 fill = \"chartreuse\", \n                 color = \"white\") +\n  labs(title = \"Histogram of avg_gloucose_level\",\n       x = \"avg-glucose_level\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-8.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = bmi)) +\n  geom_histogram(binwidth = 5, \n                 fill = \"gold\", \n                 color = \"white\") +\n  labs(title = \"Histogram of bmi\", \n       x = \"bmi\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-9.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = smoking_status)) +\n  geom_bar(fill = \"deepskyblue\", \n           color = \"white\") +\n  labs(title = \"smoking_status\", \n       x = \"smoking_status\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-10.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(strokeclean, aes(x = stroke)) +\n  geom_bar(fill = \"tan\", \n           color = \"white\") +\n  labs(title = \"Histogram of Age\", \n       x = \"stroke\", \n       y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-11.png){width=672}\n:::\n:::\n\n\nThe Three different Models of Logistic Regression: Baseline Firth and Flic Correction\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Baseline Logistic Regression\nmodel_base <- glm(formula, data=strokeclean, family=binomial)\nprob_base <- predict(model_base, type=\"response\")\n\n# Firth Logistic Regression\nmodel_firth <- logistf(formula, data=strokeclean)\nprob_firth <- predict(model_firth, type=\"response\")\n\n# FLIC Correction (this correction changes the intercept)\nmodel_flic <- flic(formula, data=strokeclean)\nprob_flic <- predict(model_flic, type=\"response\")\n\nlabels <- strokeclean$stroke\n```\n:::\n\n\nCreating Youdens J\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyouden_point <- function(roc_obj) {\n  coords <- coords(roc_obj, \"best\", best.method = \"youden\", ret=c(\"threshold\", \"sensitivity\", \"specificity\", \"youden\"))\n  return(coords)\n}\n```\n:::\n\n\nThe Three Types of Prediction with 0.5 for consistency\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predictions with default threshold 0.5 (for output consistency)\npred_base <- factor(ifelse(prob_base > 0.5, 1, 0), levels=c(0,1))\npred_firth <- factor(ifelse(prob_firth > 0.5, 1, 0), levels=c(0,1))\npred_flic <- factor(ifelse(prob_flic > 0.5, 1, 0), levels=c(0,1))\n```\n:::\n\n\nThe Function to Compute Metrics\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  pred_base <- factor(ifelse(prob_base > 0.5, 1, 0), levels=c(0,1))\n  pred_firth <- factor(ifelse(prob_firth > 0.5, 1, 0), levels=c(0,1))\n  pred_flic <- factor(ifelse(prob_flic > 0.5, 1, 0), levels=c(0,1))\n\n  metrics <- function(pred, prob, labels, name) {\n    cm <- confusionMatrix(pred, labels, positive = \"1\")\n    roc_obj <- roc(labels, as.numeric(prob))\n    auc_val <- auc(roc_obj)\n    precision <- cm$byClass[\"Pos Pred Value\"]\n    recall <- cm$byClass[\"Sensitivity\"]\n    f1 <- 2 * ((precision * recall) / (precision + recall))\n    youden <- youden_point(roc_obj)\n    # All list arguments separated by commas only, no '+'\n    list(\n      confusion = cm$table,\n      precision = precision,\n      recall = recall,\n      f1 = f1,\n      auc = auc_val,\n      roc_obj = roc_obj,\n      youden = youden,\n      model = name\n    )\n  }\n```\n:::\n\n\nIntialize Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults_base <- metrics(pred_base, prob_base, labels, \"Baseline LR\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting direction: controls < cases\n```\n\n\n:::\n\n```{.r .cell-code}\nresults_firth <- metrics(pred_firth, prob_firth, labels, \"firth LR\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\nSetting direction: controls < cases\n```\n\n\n:::\n\n```{.r .cell-code}\nresults_flic <- metrics(pred_flic, prob_flic, labels, \"flic LR\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSetting levels: control = 0, case = 1\nSetting direction: controls < cases\n```\n\n\n:::\n:::\n\n\nPrint Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"\\n== Baseline Logistic Regression ==\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n== Baseline Logistic Regression ==\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_base[1:6])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$confusion\n          Reference\nPrediction    0    1\n         0 3176  179\n         1    1    1\n\n$precision\nPos Pred Value \n           0.5 \n\n$recall\nSensitivity \n0.005555556 \n\n$f1\nPos Pred Value \n    0.01098901 \n\n$auc\nArea under the curve: 0.8295\n\n$roc_obj\n\nCall:\nroc.default(response = labels, predictor = as.numeric(prob))\n\nData: as.numeric(prob) in 3177 controls (labels 0) < 180 cases (labels 1).\nArea under the curve: 0.8295\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nYouden's J (optimal threshold):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nYouden's J (optimal threshold):\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_base$youden)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   threshold sensitivity specificity youden\n1 0.05583497   0.7888889    0.733711 1.5226\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n== Firth Logistic Regression ==\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n== Firth Logistic Regression ==\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_firth[1:6])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$confusion\n          Reference\nPrediction    0    1\n         0 3176  179\n         1    1    1\n\n$precision\nPos Pred Value \n           0.5 \n\n$recall\nSensitivity \n0.005555556 \n\n$f1\nPos Pred Value \n    0.01098901 \n\n$auc\nArea under the curve: 0.829\n\n$roc_obj\n\nCall:\nroc.default(response = labels, predictor = as.numeric(prob))\n\nData: as.numeric(prob) in 3177 controls (labels 0) < 180 cases (labels 1).\nArea under the curve: 0.829\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nYouden's J (optimal threshold):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nYouden's J (optimal threshold):\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_firth$youden)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   threshold sensitivity specificity  youden\n1 0.05759395   0.7888889   0.7330815 1.52197\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\n== FLIC Logistic Regression ==\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n== FLIC Logistic Regression ==\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_flic[1:6])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$confusion\n          Reference\nPrediction    0    1\n         0 3176  179\n         1    1    1\n\n$precision\nPos Pred Value \n           0.5 \n\n$recall\nSensitivity \n0.005555556 \n\n$f1\nPos Pred Value \n    0.01098901 \n\n$auc\nArea under the curve: 0.829\n\n$roc_obj\n\nCall:\nroc.default(response = labels, predictor = as.numeric(prob))\n\nData: as.numeric(prob) in 3177 controls (labels 0) < 180 cases (labels 1).\nArea under the curve: 0.829\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"\\nYouden's J (optimal threshold):\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nYouden's J (optimal threshold):\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(results_flic$youden)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   threshold sensitivity specificity  youden\n1 0.05583613   0.7888889   0.7330815 1.52197\n```\n\n\n:::\n:::\n\n\nPlot the ROC curves and Annotate Youden's J on each of the Curves\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(results_base$roc_obj, col=\"cyan\", main=\"ROC Curves: Baseline (blue) vs Firth (red)\")\nplot(results_firth$roc_obj, col=\"magenta\", add=TRUE)\nplot(results_flic$roc_obj, col =\"gold\", add=TRUE)\nauc(results_base$roc_obj)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nArea under the curve: 0.8295\n```\n\n\n:::\n\n```{.r .cell-code}\nauc(results_firth$roc_obj)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nArea under the curve: 0.829\n```\n\n\n:::\n\n```{.r .cell-code}\nauc(results_flic$roc_obj)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nArea under the curve: 0.829\n```\n\n\n:::\n\n```{.r .cell-code}\npoints(\n  1-results_base$youden[\"specificity\"],\n  results_base$youden[\"sensitivity\"],\n  col=\"cyan\", pch=19, cex=1.5\n)\npoints(\n  1-results_firth$youden[\"specificity\"],\n  results_firth$youden[\"sensitivity\"],\n  col=\"magenta\", pch=19, cex=1.5\n)\npoints(\n  1-results_flic$youden[\"specificity\"],\n  results_flic$youden[\"sensitivity\"],\n  col=\"gold\", pch=19, cex=1.5\n)\n\nlegend(\"bottomright\", legend=c(\"Baseline\", \"Firth\",\"flic\"), col=c(\"cyan\", \"magenta\", \"gold\"), lwd=2)\n\ntext(\n  x=1-results_base$youden[\"specificity\"], y=results_base$youden[\"sensitivity\"],\n  labels=paste0(\"Youden: \", round(results_base$youden[\"youden\"], 3)),\n  pos=4, col=\"cyan\"\n)\ntext(\n  x=1-results_firth$youden[\"specificity\"], y=results_firth$youden[\"sensitivity\"],\n  labels=paste0(\"Youden: \", round(results_firth$youden[\"youden\"], 3)),\n  pos=4, col=\"magenta\"\n)\ntext(\n  x=1-results_flic$youden[\"specificity\"], y=results_flic$youden[\"sensitivity\"],\n  labels=paste0(\"Youden: \", round(results_flic$youden[\"youden\"], 3)),\n  pos=4, col=\"gold\"\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nPlot the Confusion Matrices\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(1,2))\nfourfoldplot(results_base$confusion, color = c(\"lightskyblue\", \"plum2\"),\n             conf.level = 0, margin = 1, main = \"Baseline Confusion Matrix\")\nfourfoldplot(results_firth$confusion, color = c(\"lightskyblue\", \"plum2\"),\n             conf.level = 0, margin = 1, main = \"Firth Confusion Matrix\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfourfoldplot(results_flic$confusion, color = c(\"lightskyblue\", \"plum2\"),\n             conf.level = 0, margin = 1, main = \"Flic Confusion Matrix\")\n\npar(mfrow=c(1,1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n\n### References\n\n::: {#refs}\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}